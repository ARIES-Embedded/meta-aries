From 8f01757b9de346224c214e231a45be4281d11df7 Mon Sep 17 00:00:00 2001
From: Wolfgang Grandegger <wg@aries-embedded.de>
Date: Mon, 17 Feb 2020 20:11:02 +0100
Subject: [PATCH 7/7] arm: socfpga: Add support for Aries MAX SoM on the MAXEVK
 board

Add support for Aries MAX SoM, which is Arria10 based and the
associated Aries MAXEVK baseboard. The board can boot from eMMC
or the network. Ethernet, eMMC and UART is supported.

Signed-off-by: Wolfgang Grandegger <wg@aries-embedded.de>
---
 arch/arm/dts/Makefile                         |   1 +
 arch/arm/dts/socfpga_arria10_maxevk.dtsi      |  77 +++++
 arch/arm/dts/socfpga_arria10_maxevk_sdmmc.dts |  64 ++++
 .../socfpga_arria10_maxevk_sdmmc_handoff.dtsi | 322 ++++++++++++++++++
 arch/arm/mach-socfpga/Kconfig                 |   7 +
 board/aries/maxevk/Kconfig                    |  18 +
 board/aries/maxevk/MAINTAINERS                |   9 +
 board/aries/maxevk/Makefile                   |   5 +
 board/aries/maxevk/fit_spl_fpga.its           |  38 +++
 board/aries/maxevk/socfpga.c                  |   6 +
 configs/socfpga_maxevk_defconfig              |  52 +++
 include/configs/socfpga_maxevk.h              |  45 +++
 12 files changed, 644 insertions(+)
 create mode 100644 arch/arm/dts/socfpga_arria10_maxevk.dtsi
 create mode 100644 arch/arm/dts/socfpga_arria10_maxevk_sdmmc.dts
 create mode 100644 arch/arm/dts/socfpga_arria10_maxevk_sdmmc_handoff.dtsi
 create mode 100644 board/aries/maxevk/Kconfig
 create mode 100644 board/aries/maxevk/MAINTAINERS
 create mode 100644 board/aries/maxevk/Makefile
 create mode 100644 board/aries/maxevk/fit_spl_fpga.its
 create mode 100644 board/aries/maxevk/socfpga.c
 create mode 100644 configs/socfpga_maxevk_defconfig
 create mode 100644 include/configs/socfpga_maxevk.h

diff --git a/arch/arm/dts/Makefile b/arch/arm/dts/Makefile
index 326ecdfb60..75687afcf9 100644
--- a/arch/arm/dts/Makefile
+++ b/arch/arm/dts/Makefile
@@ -330,6 +330,7 @@ dtb-$(CONFIG_THUNDERX) += thunderx-88xx.dtb
 
 dtb-$(CONFIG_ARCH_SOCFPGA) +=				\
 	socfpga_arria5_socdk.dtb			\
+	socfpga_arria10_maxevk_sdmmc.dtb		\
 	socfpga_arria10_socdk_sdmmc.dtb			\
 	socfpga_cyclone5_mcvevk.dtb			\
 	socfpga_cyclone5_is1.dtb			\
diff --git a/arch/arm/dts/socfpga_arria10_maxevk.dtsi b/arch/arm/dts/socfpga_arria10_maxevk.dtsi
new file mode 100644
index 0000000000..b2677f1ba6
--- /dev/null
+++ b/arch/arm/dts/socfpga_arria10_maxevk.dtsi
@@ -0,0 +1,77 @@
+// SPDX-License-Identifier: GPL-2.0+
+/*
+ * Copyright (C) 2020 Wolfgang Grandegger <wg@aries-embedded.de>
+ */
+
+#include "socfpga_arria10.dtsi"
+
+/ {
+	model = "Aries MAX EVK";
+	compatible = "aries,maxevk", "altr,socfpga-arria10", "altr,socfpga";
+
+	aliases {
+		ethernet0 = &gmac1;
+		ethernet1 = &gmac2;
+		serial0 = &uart0;
+	};
+
+	chosen {
+		bootargs = "earlyprintk";
+		stdout-path = "serial0:115200n8";
+	};
+
+	memory@0 {
+		name = "memory";
+		device_type = "memory";
+		reg = <0x0 0x80000000>; /* 2GB */
+		u-boot,dm-pre-reloc;
+	};
+
+	soc {
+		u-boot,dm-pre-reloc;
+	};
+};
+
+&gmac1 {
+	phy-mode = "rgmii";
+	phy-addr = <0>;
+	status = "okay";
+};
+
+&gmac2 {
+	phy-mode = "rgmii";
+	phy-addr = <0>;
+	status = "okay";
+};
+
+&gpio1 {
+	status = "disabled";
+};
+
+&uart0 {
+	u-boot,dm-pre-reloc;
+	status = "okay";
+};
+
+&usb1 {
+	status = "okay";
+	external-vbus-supply;
+	//disable-over-current;
+};
+
+&watchdog1 {
+	status = "okay";
+};
+
+/* Clock available early */
+&main_periph_ref_clk {
+	u-boot,dm-pre-reloc;
+};
+
+&l4_mp_clk {
+	u-boot,dm-pre-reloc;
+};
+
+&l4_sp_clk {
+	u-boot,dm-pre-reloc;
+};
diff --git a/arch/arm/dts/socfpga_arria10_maxevk_sdmmc.dts b/arch/arm/dts/socfpga_arria10_maxevk_sdmmc.dts
new file mode 100644
index 0000000000..a074427025
--- /dev/null
+++ b/arch/arm/dts/socfpga_arria10_maxevk_sdmmc.dts
@@ -0,0 +1,64 @@
+// SPDX-License-Identifier: GPL-2.0+
+/*
+ * Copyright (C) 2020 Wolfgang Grandegger <wg@aries-embedded.de>
+ */
+
+/dts-v1/;
+#include "socfpga_arria10_maxevk.dtsi"
+#include "socfpga_arria10_maxevk_sdmmc_handoff.dtsi"
+#include "socfpga_arria10_handoff_u-boot.dtsi"
+
+/ {
+	chosen {
+		firmware-loader = <&fs_loader0>;
+	};
+
+	fs_loader0: fs-loader {
+		u-boot,dm-pre-reloc;
+		compatible = "u-boot,fs-loader";
+		phandlepart = <&mmc 1>;
+	};
+};
+
+&fpga_mgr {
+	u-boot,dm-pre-reloc;
+	altr,bitstream = "fit_spl_fpga.itb";
+};
+
+&mmc {
+	u-boot,dm-pre-reloc;
+	status = "okay";
+	num-slots = <1>;
+	cap-sd-highspeed;
+	broken-cd;
+	bus-width = <8>;
+};
+
+&eccmgr {
+	sdmmca-ecc@ff8c2c00 {
+		compatible = "altr,socfpga-sdmmc-ecc";
+		reg = <0xff8c2c00 0x400>;
+		altr,ecc-parent = <&mmc>;
+		interrupts = <15 IRQ_TYPE_LEVEL_HIGH>,
+			     <47 IRQ_TYPE_LEVEL_HIGH>,
+			     <16 IRQ_TYPE_LEVEL_HIGH>,
+			     <48 IRQ_TYPE_LEVEL_HIGH>;
+	};
+};
+
+/* Clock available early */
+&main_sdmmc_clk {
+	u-boot,dm-pre-reloc;
+};
+
+&peri_sdmmc_clk {
+	u-boot,dm-pre-reloc;
+};
+
+&sdmmc_free_clk {
+	u-boot,dm-pre-reloc;
+};
+
+&sdmmc_clk {
+	u-boot,dm-pre-reloc;
+};
diff --git a/arch/arm/dts/socfpga_arria10_maxevk_sdmmc_handoff.dtsi b/arch/arm/dts/socfpga_arria10_maxevk_sdmmc_handoff.dtsi
new file mode 100644
index 0000000000..1d09fb2e9c
--- /dev/null
+++ b/arch/arm/dts/socfpga_arria10_maxevk_sdmmc_handoff.dtsi
@@ -0,0 +1,322 @@
+/* Insert your license and copyright header here. */
+
+/*
+ * Bootloader: uboot
+ * Version: 1.0
+ */
+/ {
+	#address-cells = <1>;
+	#size-cells = <1>;
+	model = "Aries MAX EVK";	/* Bootloader setting: uboot.model */
+
+	/* Clock sources */
+	clocks {
+		#address-cells = <1>;
+		#size-cells = <1>;
+
+		/* Clock source: altera_arria10_hps_eosc1 */
+		altera_arria10_hps_eosc1: altera_arria10_hps_eosc1 {
+			compatible = "fixed-clock";
+			#clock-cells = <0>;
+			clock-frequency = <25000000>;
+			clock-output-names = "altera_arria10_hps_eosc1-clk";
+		};
+
+		/* Clock source: altera_arria10_hps_cb_intosc_ls */
+		altera_arria10_hps_cb_intosc_ls: altera_arria10_hps_cb_intosc_ls {
+			compatible = "fixed-clock";
+			#clock-cells = <0>;
+			clock-frequency = <60000000>;
+			clock-output-names = "altera_arria10_hps_cb_intosc_ls-clk";
+		};
+
+		/* Clock source: altera_arria10_hps_f2h_free */
+		altera_arria10_hps_f2h_free: altera_arria10_hps_f2h_free {
+			compatible = "fixed-clock";
+			#clock-cells = <0>;
+			clock-frequency = <200000000>;
+			clock-output-names = "altera_arria10_hps_f2h_free-clk";
+		};
+	};
+
+	/*
+	 * Driver: altera_arria10_soc_clock_manager_arria10_uboot_driver
+	 * Version: 1.0
+	 * Binding: device
+	 */
+	i_clk_mgr: clock_manager@0xffd04000 {
+		compatible = "altr,socfpga-a10-clk-init";
+		reg = <0xffd04000 0x00000200>;
+		reg-names = "soc_clock_manager_OCP_SLV";
+
+		/* Address Block: soc_clock_manager_OCP_SLV.i_clk_mgr_mainpllgrp */
+		mainpll {
+			vco0-psrc = <0>;	/* Field: vco0.psrc */
+			vco1-denom = <1>;	/* Field: vco1.denom */
+			vco1-numer = <239>;	/* Field: vco1.numer */
+			mpuclk-cnt = <0>;	/* Field: mpuclk.cnt */
+			mpuclk-src = <0>;	/* Field: mpuclk.src */
+			nocclk-cnt = <0>;	/* Field: nocclk.cnt */
+			nocclk-src = <0>;	/* Field: nocclk.src */
+			cntr2clk-cnt = <900>;	/* Field: cntr2clk.cnt */
+			cntr3clk-cnt = <900>;	/* Field: cntr3clk.cnt */
+			cntr4clk-cnt = <900>;	/* Field: cntr4clk.cnt */
+			cntr5clk-cnt = <900>;	/* Field: cntr5clk.cnt */
+			cntr6clk-cnt = <14>;	/* Field: cntr6clk.cnt */
+			cntr7clk-cnt = <59>;	/* Field: cntr7clk.cnt */
+			cntr7clk-src = <0>;	/* Field: cntr7clk.src */
+			cntr8clk-cnt = <900>;	/* Field: cntr8clk.cnt */
+			cntr9clk-cnt = <900>;	/* Field: cntr9clk.cnt */
+			cntr9clk-src = <0>;	/* Field: cntr9clk.src */
+			cntr15clk-cnt = <900>;	/* Field: cntr15clk.cnt */
+			nocdiv-l4mainclk = <0>;	/* Field: nocdiv.l4mainclk */
+			nocdiv-l4mpclk = <1>;	/* Field: nocdiv.l4mpclk */
+			nocdiv-l4spclk = <2>;	/* Field: nocdiv.l4spclk */
+			nocdiv-csatclk = <0>;	/* Field: nocdiv.csatclk */
+			nocdiv-cstraceclk = <0>;	/* Field: nocdiv.cstraceclk */
+			nocdiv-cspdbgclk = <1>;	/* Field: nocdiv.cspdbgclk */
+		};
+
+		/* Address Block: soc_clock_manager_OCP_SLV.i_clk_mgr_perpllgrp */
+		perpll {
+			vco0-psrc = <0>;	/* Field: vco0.psrc */
+			vco1-denom = <1>;	/* Field: vco1.denom */
+			vco1-numer = <239>;	/* Field: vco1.numer */
+			cntr2clk-cnt = <11>;	/* Field: cntr2clk.cnt */
+			cntr2clk-src = <1>;	/* Field: cntr2clk.src */
+			cntr3clk-cnt = <900>;	/* Field: cntr3clk.cnt */
+			cntr3clk-src = <1>;	/* Field: cntr3clk.src */
+			cntr4clk-cnt = <29>;	/* Field: cntr4clk.cnt */
+			cntr4clk-src = <1>;	/* Field: cntr4clk.src */
+			cntr5clk-cnt = <749>;	/* Field: cntr5clk.cnt */
+			cntr5clk-src = <1>;	/* Field: cntr5clk.src */
+			cntr6clk-cnt = <900>;	/* Field: cntr6clk.cnt */
+			cntr6clk-src = <0>;	/* Field: cntr6clk.src */
+			cntr7clk-cnt = <900>;	/* Field: cntr7clk.cnt */
+			cntr8clk-cnt = <900>;	/* Field: cntr8clk.cnt */
+			cntr8clk-src = <0>;	/* Field: cntr8clk.src */
+			cntr9clk-cnt = <900>;	/* Field: cntr9clk.cnt */
+			emacctl-emac0sel = <0>;	/* Field: emacctl.emac0sel */
+			emacctl-emac1sel = <0>;	/* Field: emacctl.emac1sel */
+			emacctl-emac2sel = <0>;	/* Field: emacctl.emac2sel */
+			gpiodiv-gpiodbclk = <32000>;	/* Field: gpiodiv.gpiodbclk */
+		};
+
+		/* Address Block: soc_clock_manager_OCP_SLV.i_clk_mgr_alteragrp */
+		alteragrp {
+			nocclk = <0x03840007>;	/* Register: nocclk */
+			mpuclk = <0x03840001>;	/* Register: mpuclk */
+		};
+	};
+
+	/*
+	 * Driver: altera_arria10_soc_3v_io48_pin_mux_arria10_uboot_driver
+	 * Version: 1.0
+	 * Binding: pinmux
+	 */
+	i_io48_pin_mux: pinmux@0xffd07000 {
+		#address-cells = <1>;
+		#size-cells = <1>;
+		compatible = "pinctrl-single";
+		reg = <0xffd07000 0x00000800>;
+		reg-names = "soc_3v_io48_pin_mux_OCP_SLV";
+
+		/* Address Block: soc_3v_io48_pin_mux_OCP_SLV.i_io48_pin_mux_shared_3v_io_grp */
+		shared {
+			reg = <0xffd07000 0x00000200>;
+			pinctrl-single,register-width = <32>;
+			pinctrl-single,function-mask = <0x0000000f>;
+			pinctrl-single,pins =
+				<0x00000000 0x0000000f>,	/* Register: pinmux_shared_io_q1_1 */
+				<0x00000004 0x0000000f>,	/* Register: pinmux_shared_io_q1_2 */
+				<0x00000008 0x0000000d>,	/* Register: pinmux_shared_io_q1_3 */
+				<0x0000000c 0x0000000d>,	/* Register: pinmux_shared_io_q1_4 */
+				<0x00000010 0x0000000f>,	/* Register: pinmux_shared_io_q1_5 */
+				<0x00000014 0x0000000f>,	/* Register: pinmux_shared_io_q1_6 */
+				<0x00000018 0x00000001>,	/* Register: pinmux_shared_io_q1_7 */
+				<0x0000001c 0x00000001>,	/* Register: pinmux_shared_io_q1_8 */
+				<0x00000020 0x00000001>,	/* Register: pinmux_shared_io_q1_9 */
+				<0x00000024 0x00000001>,	/* Register: pinmux_shared_io_q1_10 */
+				<0x00000028 0x0000000a>,	/* Register: pinmux_shared_io_q1_11 */
+				<0x0000002c 0x0000000a>,	/* Register: pinmux_shared_io_q1_12 */
+				<0x00000030 0x00000008>,	/* Register: pinmux_shared_io_q2_1 */
+				<0x00000034 0x00000008>,	/* Register: pinmux_shared_io_q2_2 */
+				<0x00000038 0x00000008>,	/* Register: pinmux_shared_io_q2_3 */
+				<0x0000003c 0x00000008>,	/* Register: pinmux_shared_io_q2_4 */
+				<0x00000040 0x00000008>,	/* Register: pinmux_shared_io_q2_5 */
+				<0x00000044 0x00000008>,	/* Register: pinmux_shared_io_q2_6 */
+				<0x00000048 0x00000008>,	/* Register: pinmux_shared_io_q2_7 */
+				<0x0000004c 0x00000008>,	/* Register: pinmux_shared_io_q2_8 */
+				<0x00000050 0x00000008>,	/* Register: pinmux_shared_io_q2_9 */
+				<0x00000054 0x00000008>,	/* Register: pinmux_shared_io_q2_10 */
+				<0x00000058 0x00000008>,	/* Register: pinmux_shared_io_q2_11 */
+				<0x0000005c 0x00000008>,	/* Register: pinmux_shared_io_q2_12 */
+				<0x00000060 0x00000008>,	/* Register: pinmux_shared_io_q3_1 */
+				<0x00000064 0x00000008>,	/* Register: pinmux_shared_io_q3_2 */
+				<0x00000068 0x00000008>,	/* Register: pinmux_shared_io_q3_3 */
+				<0x0000006c 0x00000008>,	/* Register: pinmux_shared_io_q3_4 */
+				<0x00000070 0x00000008>,	/* Register: pinmux_shared_io_q3_5 */
+				<0x00000074 0x00000008>,	/* Register: pinmux_shared_io_q3_6 */
+				<0x00000078 0x00000008>,	/* Register: pinmux_shared_io_q3_7 */
+				<0x0000007c 0x00000008>,	/* Register: pinmux_shared_io_q3_8 */
+				<0x00000080 0x00000008>,	/* Register: pinmux_shared_io_q3_9 */
+				<0x00000084 0x00000008>,	/* Register: pinmux_shared_io_q3_10 */
+				<0x00000088 0x00000008>,	/* Register: pinmux_shared_io_q3_11 */
+				<0x0000008c 0x00000008>,	/* Register: pinmux_shared_io_q3_12 */
+				<0x00000090 0x00000008>,	/* Register: pinmux_shared_io_q4_1 */
+				<0x00000094 0x00000008>,	/* Register: pinmux_shared_io_q4_2 */
+				<0x00000098 0x00000008>,	/* Register: pinmux_shared_io_q4_3 */
+				<0x0000009c 0x00000008>,	/* Register: pinmux_shared_io_q4_4 */
+				<0x000000a0 0x00000008>,	/* Register: pinmux_shared_io_q4_5 */
+				<0x000000a4 0x00000008>,	/* Register: pinmux_shared_io_q4_6 */
+				<0x000000a8 0x00000008>,	/* Register: pinmux_shared_io_q4_7 */
+				<0x000000ac 0x00000008>,	/* Register: pinmux_shared_io_q4_8 */
+				<0x000000b0 0x00000008>,	/* Register: pinmux_shared_io_q4_9 */
+				<0x000000b4 0x00000008>,	/* Register: pinmux_shared_io_q4_10 */
+				<0x000000b8 0x00000008>,	/* Register: pinmux_shared_io_q4_11 */
+				<0x000000bc 0x00000008>;	/* Register: pinmux_shared_io_q4_12 */
+		};
+
+		/* Address Block: soc_3v_io48_pin_mux_OCP_SLV.i_io48_pin_mux_dedicated_io_grp */
+		dedicated {
+			reg = <0xffd07200 0x00000200>;
+			pinctrl-single,register-width = <32>;
+			pinctrl-single,function-mask = <0x0000000f>;
+			pinctrl-single,pins =
+				<0x0000000c 0x00000008>,	/* Register: pinmux_dedicated_io_4 */
+				<0x00000010 0x00000008>,	/* Register: pinmux_dedicated_io_5 */
+				<0x00000014 0x00000008>,	/* Register: pinmux_dedicated_io_6 */
+				<0x00000018 0x00000008>,	/* Register: pinmux_dedicated_io_7 */
+				<0x0000001c 0x00000008>,	/* Register: pinmux_dedicated_io_8 */
+				<0x00000020 0x00000008>,	/* Register: pinmux_dedicated_io_9 */
+				<0x00000024 0x0000000f>,	/* Register: pinmux_dedicated_io_10 */
+				<0x00000028 0x0000000f>,	/* Register: pinmux_dedicated_io_11 */
+				<0x0000002c 0x00000008>,	/* Register: pinmux_dedicated_io_12 */
+				<0x00000030 0x00000008>,	/* Register: pinmux_dedicated_io_13 */
+				<0x00000034 0x00000008>,	/* Register: pinmux_dedicated_io_14 */
+				<0x00000038 0x00000008>,	/* Register: pinmux_dedicated_io_15 */
+				<0x0000003c 0x0000000f>,	/* Register: pinmux_dedicated_io_16 */
+				<0x00000040 0x0000000f>;	/* Register: pinmux_dedicated_io_17 */
+		};
+
+		/* Address Block: soc_3v_io48_pin_mux_OCP_SLV.i_io48_pin_mux_dedicated_io_grp */
+		dedicated_cfg {
+			reg = <0xffd07200 0x00000200>;
+			pinctrl-single,register-width = <32>;
+			pinctrl-single,function-mask = <0x003f3f3f>;
+			pinctrl-single,pins =
+				<0x00000100 0x00000101>,	/* Register: configuration_dedicated_io_bank */
+				<0x00000104 0x000b080a>,	/* Register: configuration_dedicated_io_1 */
+				<0x00000108 0x000b080a>,	/* Register: configuration_dedicated_io_2 */
+				<0x0000010c 0x000b080a>,	/* Register: configuration_dedicated_io_3 */
+				<0x00000110 0x000a282a>,	/* Register: configuration_dedicated_io_4 */
+				<0x00000114 0x000a282a>,	/* Register: configuration_dedicated_io_5 */
+				<0x00000118 0x0008282a>,	/* Register: configuration_dedicated_io_6 */
+				<0x0000011c 0x000a282a>,	/* Register: configuration_dedicated_io_7 */
+				<0x00000120 0x000a282a>,	/* Register: configuration_dedicated_io_8 */
+				<0x00000124 0x000a282a>,	/* Register: configuration_dedicated_io_9 */
+				<0x00000128 0x000a282a>,	/* Register: configuration_dedicated_io_10 */
+				<0x0000012c 0x000a282a>,	/* Register: configuration_dedicated_io_11 */
+				<0x00000130 0x000a282a>,	/* Register: configuration_dedicated_io_12 */
+				<0x00000134 0x000a282a>,	/* Register: configuration_dedicated_io_13 */
+				<0x00000138 0x000a282a>,	/* Register: configuration_dedicated_io_14 */
+				<0x0000013c 0x000a282a>,	/* Register: configuration_dedicated_io_15 */
+				<0x00000140 0x000a282a>,	/* Register: configuration_dedicated_io_16 */
+				<0x00000144 0x000a282a>;	/* Register: configuration_dedicated_io_17 */
+		};
+
+		/* Address Block: soc_3v_io48_pin_mux_OCP_SLV.i_io48_pin_mux_fpga_interface_grp */
+		fpga {
+			reg = <0xffd07400 0x00000100>;
+			pinctrl-single,register-width = <32>;
+			pinctrl-single,function-mask = <0x00000001>;
+			pinctrl-single,pins =
+				<0x00000000 0x00000000>,	/* Register: pinmux_emac0_usefpga */
+				<0x00000004 0x00000000>,	/* Register: pinmux_emac1_usefpga */
+				<0x00000008 0x00000000>,	/* Register: pinmux_emac2_usefpga */
+				<0x0000000c 0x00000000>,	/* Register: pinmux_i2c0_usefpga */
+				<0x00000010 0x00000000>,	/* Register: pinmux_i2c1_usefpga */
+				<0x00000014 0x00000000>,	/* Register: pinmux_i2c_emac0_usefpga */
+				<0x00000018 0x00000000>,	/* Register: pinmux_i2c_emac1_usefpga */
+				<0x0000001c 0x00000000>,	/* Register: pinmux_i2c_emac2_usefpga */
+				<0x00000020 0x00000000>,	/* Register: pinmux_nand_usefpga */
+				<0x00000024 0x00000000>,	/* Register: pinmux_qspi_usefpga */
+				<0x00000028 0x00000000>,	/* Register: pinmux_sdmmc_usefpga */
+				<0x0000002c 0x00000000>,	/* Register: pinmux_spim0_usefpga */
+				<0x00000030 0x00000000>,	/* Register: pinmux_spim1_usefpga */
+				<0x00000034 0x00000000>,	/* Register: pinmux_spis0_usefpga */
+				<0x00000038 0x00000000>,	/* Register: pinmux_spis1_usefpga */
+				<0x0000003c 0x00000000>,	/* Register: pinmux_uart0_usefpga */
+				<0x00000040 0x00000000>;	/* Register: pinmux_uart1_usefpga */
+		};
+	};
+
+	/*
+	 * Driver: altera_arria10_soc_noc_arria10_uboot_driver
+	 * Version: 1.0
+	 * Binding: device
+	 */
+	i_noc: noc@0xffd10000 {
+		compatible = "altr,socfpga-a10-noc";
+		reg = <0xffd10000 0x00008000>;
+		reg-names = "mpu_m0";
+
+		firewall {
+			/*
+			 * Driver setting: altera_arria10_soc_noc_arria10_uboot_driver.I_NOC.mpu_m0.noc_fw_ddr_mpu_fpga2sdram_ddr_scr.mpuregion0addr.base
+			 * Driver setting: altera_arria10_soc_noc_arria10_uboot_driver.I_NOC.mpu_m0.noc_fw_ddr_mpu_fpga2sdram_ddr_scr.mpuregion0addr.limit
+			 */
+			mpu0 = <0x00000000 0x0000ffff>;
+			/*
+			 * Driver setting: altera_arria10_soc_noc_arria10_uboot_driver.I_NOC.mpu_m0.noc_fw_ddr_l3_ddr_scr.hpsregion0addr.base
+			 * Driver setting: altera_arria10_soc_noc_arria10_uboot_driver.I_NOC.mpu_m0.noc_fw_ddr_l3_ddr_scr.hpsregion0addr.limit
+			 */
+			l3-0 = <0x00000000 0x0000ffff>;
+			/*
+			 * Driver setting: altera_arria10_soc_noc_arria10_uboot_driver.I_NOC.mpu_m0.noc_fw_ddr_mpu_fpga2sdram_ddr_scr.fpga2sdram0region0addr.base
+			 * Driver setting: altera_arria10_soc_noc_arria10_uboot_driver.I_NOC.mpu_m0.noc_fw_ddr_mpu_fpga2sdram_ddr_scr.fpga2sdram0region0addr.limit
+			 */
+			fpga2sdram0-0 = <0x00000000 0x0000ffff>;
+			/*
+			 * Driver setting: altera_arria10_soc_noc_arria10_uboot_driver.I_NOC.mpu_m0.noc_fw_ddr_mpu_fpga2sdram_ddr_scr.fpga2sdram1region0addr.base
+			 * Driver setting: altera_arria10_soc_noc_arria10_uboot_driver.I_NOC.mpu_m0.noc_fw_ddr_mpu_fpga2sdram_ddr_scr.fpga2sdram1region0addr.limit
+			 */
+			fpga2sdram1-0 = <0x00000000 0x0000ffff>;
+			/*
+			 * Driver setting: altera_arria10_soc_noc_arria10_uboot_driver.I_NOC.mpu_m0.noc_fw_ddr_mpu_fpga2sdram_ddr_scr.fpga2sdram2region0addr.base
+			 * Driver setting: altera_arria10_soc_noc_arria10_uboot_driver.I_NOC.mpu_m0.noc_fw_ddr_mpu_fpga2sdram_ddr_scr.fpga2sdram2region0addr.limit
+			 */
+			fpga2sdram2-0 = <0x00000000 0x0000ffff>;
+		};
+	};
+
+	hps_fpgabridge0: fpgabridge@0 {
+		compatible = "altr,socfpga-hps2fpga-bridge";
+		init-val = <1>;
+	};
+
+	hps_fpgabridge1: fpgabridge@1 {
+		compatible = "altr,socfpga-lwhps2fpga-bridge";
+		init-val = <1>;
+	};
+
+	hps_fpgabridge2: fpgabridge@2 {
+		compatible = "altr,socfpga-fpga2hps-bridge";
+		init-val = <1>;
+	};
+
+	hps_fpgabridge3: fpgabridge@3 {
+		compatible = "altr,socfpga-fpga2sdram0-bridge";
+		init-val = <1>;
+	};
+
+	hps_fpgabridge4: fpgabridge@4 {
+		compatible = "altr,socfpga-fpga2sdram1-bridge";
+		init-val = <0>;
+	};
+
+	hps_fpgabridge5: fpgabridge@5 {
+		compatible = "altr,socfpga-fpga2sdram2-bridge";
+		init-val = <1>;
+	};
+};
diff --git a/arch/arm/mach-socfpga/Kconfig b/arch/arm/mach-socfpga/Kconfig
index 3770e07258..64ed3faffd 100644
--- a/arch/arm/mach-socfpga/Kconfig
+++ b/arch/arm/mach-socfpga/Kconfig
@@ -79,6 +79,10 @@ config TARGET_SOCFPGA_ARIES_MCVEVK
 	bool "Aries MCVEVK (Cyclone V)"
 	select TARGET_SOCFPGA_CYCLONE5
 
+config TARGET_SOCFPGA_ARRIA10_MAXEVK
+	bool "Aries MAXEVK (Arria 10)"
+	select TARGET_SOCFPGA_ARRIA10
+
 config TARGET_SOCFPGA_ARRIA10_SOCDK
 	bool "Altera SOCFPGA SoCDK (Arria 10)"
 	select TARGET_SOCFPGA_ARRIA10
@@ -143,6 +147,7 @@ config SYS_BOARD
 	default "de1-soc" if TARGET_SOCFPGA_TERASIC_DE1_SOC
 	default "de10-nano" if TARGET_SOCFPGA_TERASIC_DE10_NANO
 	default "is1" if TARGET_SOCFPGA_IS1
+	default "maxevk" if TARGET_SOCFPGA_ARRIA10_MAXEVK
 	default "mcvevk" if TARGET_SOCFPGA_ARIES_MCVEVK
 	default "sockit" if TARGET_SOCFPGA_TERASIC_SOCKIT
 	default "socrates" if TARGET_SOCFPGA_EBV_SOCRATES
@@ -155,6 +160,7 @@ config SYS_VENDOR
 	default "altera" if TARGET_SOCFPGA_ARRIA10_SOCDK
 	default "altera" if TARGET_SOCFPGA_CYCLONE5_SOCDK
 	default "altera" if TARGET_SOCFPGA_STRATIX10_SOCDK
+	default "aries" if TARGET_SOCFPGA_ARRIA10_MAXEVK
 	default "aries" if TARGET_SOCFPGA_ARIES_MCVEVK
 	default "devboards" if TARGET_SOCFPGA_DEVBOARDS_DBM_SOC1
 	default "ebv" if TARGET_SOCFPGA_EBV_SOCRATES
@@ -176,6 +182,7 @@ config SYS_CONFIG_NAME
 	default "socfpga_de1_soc" if TARGET_SOCFPGA_TERASIC_DE1_SOC
 	default "socfpga_de10_nano" if TARGET_SOCFPGA_TERASIC_DE10_NANO
 	default "socfpga_is1" if TARGET_SOCFPGA_IS1
+	default "socfpga_maxevk" if TARGET_SOCFPGA_ARRIA10_MAXEVK
 	default "socfpga_mcvevk" if TARGET_SOCFPGA_ARIES_MCVEVK
 	default "socfpga_sockit" if TARGET_SOCFPGA_TERASIC_SOCKIT
 	default "socfpga_socrates" if TARGET_SOCFPGA_EBV_SOCRATES
diff --git a/board/aries/maxevk/Kconfig b/board/aries/maxevk/Kconfig
new file mode 100644
index 0000000000..c1738d864b
--- /dev/null
+++ b/board/aries/maxevk/Kconfig
@@ -0,0 +1,18 @@
+if TARGET_SOCFPGA_ARRIA10_MAXEVK
+
+config SYS_CPU
+	default "armv7"
+
+config SYS_BOARD
+	default "maxevk"
+
+config SYS_VENDOR
+	default "aries"
+
+config SYS_SOC
+	default "socfpga_arria10"
+
+config SYS_CONFIG_NAME
+	default "socfpga_maxevk"
+
+endif
diff --git a/board/aries/maxevk/MAINTAINERS b/board/aries/maxevk/MAINTAINERS
new file mode 100644
index 0000000000..f3cba697fc
--- /dev/null
+++ b/board/aries/maxevk/MAINTAINERS
@@ -0,0 +1,9 @@
+Aries MAXEVK BOARD
+M:	Wolfgang Grandegger <wg@aries-embedded.de>
+S:	Maintained
+F:	board/aries/maxevk/
+F:	include/configs/socfpga_maxevk.h
+F:	configs/socfpga_maxevk_defconfig
+F:	arch/arm/dts/socfpga_arria10_maxevk_sdmmc.dts
+F:	arch/arm/dts/socfpga_arria10_maxevk.dtsi
+F:	arch/arm/dts/socfpga_arria10_maxevk_sdmmc_handoff.dtsi
diff --git a/board/aries/maxevk/Makefile b/board/aries/maxevk/Makefile
new file mode 100644
index 0000000000..80d0004346
--- /dev/null
+++ b/board/aries/maxevk/Makefile
@@ -0,0 +1,5 @@
+# SPDX-License-Identifier: GPL-2.0
+#
+# Copyright (C) 2015 Altera Corporation <www.altera.com>
+
+obj-y	:= socfpga.o
diff --git a/board/aries/maxevk/fit_spl_fpga.its b/board/aries/maxevk/fit_spl_fpga.its
new file mode 100644
index 0000000000..ae23d65d1c
--- /dev/null
+++ b/board/aries/maxevk/fit_spl_fpga.its
@@ -0,0 +1,38 @@
+// SPDX-License-Identifier: GPL-2.0
+ /*
+ * Copyright (C) 2019 Intel Corporation <www.intel.com>
+ *
+ */
+
+/dts-v1/;
+
+/ {
+	description = "FIT image with FPGA bistream";
+	#address-cells = <1>;
+
+	images {
+		fpga-periph-1 {
+			description = "FPGA peripheral bitstream";
+			data = /incbin/("../../../DBM_SoC3_startup.periph.rbf");
+			type = "fpga";
+			arch = "arm";
+			compression = "none";
+		};
+
+		fpga-core-1 {
+			description = "FPGA core bitstream";
+			data = /incbin/("../../../DBM_SoC3_startup.core.rbf");
+			type = "fpga";
+			arch = "arm";
+			compression = "none";
+		};
+	};
+
+	configurations {
+		default = "config-1";
+		config-1 {
+			description = "Boot with FPGA early IO release config";
+			fpga = "fpga-periph-1", "fpga-core-1";
+		};
+	};
+};
diff --git a/board/aries/maxevk/socfpga.c b/board/aries/maxevk/socfpga.c
new file mode 100644
index 0000000000..4c466cb944
--- /dev/null
+++ b/board/aries/maxevk/socfpga.c
@@ -0,0 +1,6 @@
+// SPDX-License-Identifier: GPL-2.0
+/*
+ * Copyright (C) 2015 Altera Corporation <www.altera.com>
+ */
+
+#include <common.h>
diff --git a/configs/socfpga_maxevk_defconfig b/configs/socfpga_maxevk_defconfig
new file mode 100644
index 0000000000..05feda708b
--- /dev/null
+++ b/configs/socfpga_maxevk_defconfig
@@ -0,0 +1,52 @@
+CONFIG_ARM=y
+CONFIG_ARCH_SOCFPGA=y
+CONFIG_SPL_DRIVERS_MISC_SUPPORT=y
+CONFIG_ENV_SIZE=0x2000
+CONFIG_ENV_OFFSET=0x4400
+CONFIG_TARGET_SOCFPGA_ARRIA10_MAXEVK=y
+CONFIG_IDENT_STRING="socfpga_arria10"
+CONFIG_SPL_FS_FAT=y
+CONFIG_SPL_TEXT_BASE=0xFFE00000
+CONFIG_DISTRO_DEFAULTS=y
+CONFIG_FIT=y
+CONFIG_SPL_FIT=y
+CONFIG_USE_BOOTARGS=y
+CONFIG_BOOTARGS="console=ttyS0,115200"
+# CONFIG_USE_BOOTCOMMAND is not set
+CONFIG_SYS_CONSOLE_IS_IN_ENV=y
+CONFIG_SYS_CONSOLE_OVERWRITE_ROUTINE=y
+CONFIG_SYS_CONSOLE_ENV_OVERWRITE=y
+CONFIG_DEFAULT_FDT_FILE="socfpga_arria10_maxevk_sdmmc.dtb"
+CONFIG_VERSION_VARIABLE=y
+CONFIG_DISPLAY_BOARDINFO_LATE=y
+CONFIG_SPL_ENV_SUPPORT=y
+CONFIG_SPL_FPGA_SUPPORT=y
+CONFIG_CMD_ASKENV=y
+CONFIG_CMD_GREPENV=y
+# CONFIG_CMD_FLASH is not set
+CONFIG_CMD_GPIO=y
+CONFIG_CMD_MMC=y
+CONFIG_CMD_CACHE=y
+CONFIG_CMD_EXT4_WRITE=y
+CONFIG_MTDIDS_DEFAULT="nor0=ff705000.spi.0"
+CONFIG_DEFAULT_DEVICE_TREE="socfpga_arria10_maxevk_sdmmc"
+CONFIG_OF_SPL_REMOVE_PROPS="interrupts interrupt-parent dmas dma-names"
+CONFIG_ENV_IS_IN_MMC=y
+CONFIG_SYS_RELOC_GD_ENV_ADDR=y
+CONFIG_SPL_DM_SEQ_ALIAS=y
+CONFIG_DM_GPIO=y
+CONFIG_DWAPB_GPIO=y
+CONFIG_FS_LOADER=y
+CONFIG_DM_MMC=y
+CONFIG_MMC_DW=y
+CONFIG_MTD=y
+CONFIG_PHY_MICREL=y
+CONFIG_PHY_MICREL_KSZ90X1=y
+CONFIG_DM_ETH=y
+CONFIG_ETH_DESIGNWARE=y
+CONFIG_MII=y
+CONFIG_SPI=y
+CONFIG_TIMER=y
+CONFIG_SPL_TIMER=y
+CONFIG_DESIGNWARE_APB_TIMER=y
+# CONFIG_SPL_WDT is not set
diff --git a/include/configs/socfpga_maxevk.h b/include/configs/socfpga_maxevk.h
new file mode 100644
index 0000000000..26a5f4e6ef
--- /dev/null
+++ b/include/configs/socfpga_maxevk.h
@@ -0,0 +1,45 @@
+/* SPDX-License-Identifier: GPL-2.0 */
+/*
+ *  Copyright (C) 2015-2019 Altera Corporation <www.altera.com>
+ */
+
+#ifndef __CONFIG_SOCFGPA_MAXEVK_H__
+#define __CONFIG_SOCFGPA_MAXEVK_H__
+
+#include <asm/arch/base_addr_a10.h>
+
+/* Booting Linux */
+#define CONFIG_LOADADDR		0x01000000
+#define CONFIG_SYS_LOAD_ADDR	CONFIG_LOADADDR
+
+/*
+ * U-Boot general configurations
+ */
+
+/* Memory configurations  */
+#define PHYS_SDRAM_1_SIZE		0x40000000
+
+/*
+ * Serial / UART configurations
+ */
+#define CONFIG_SYS_NS16550_MEM32
+#define CONFIG_SYS_BAUDRATE_TABLE {4800, 9600, 19200, 38400, 57600, 115200}
+
+/*
+ * L4 OSC1 Timer 0
+ */
+/* reload value when timer count to zero */
+#define TIMER_LOAD_VAL			0xFFFFFFFF
+
+/*
+ * Flash configurations
+ */
+#define CONFIG_SYS_MAX_FLASH_BANKS     1
+
+/* SPL memory allocation configuration, this is for FAT implementation */
+#define CONFIG_SYS_SPL_MALLOC_SIZE	0x00015000
+
+/* The rest of the configuration is shared */
+#include <configs/socfpga_common.h>
+
+#endif	/* __CONFIG_SOCFGPA_MAXEVK_H__ */
-- 
2.28.0

